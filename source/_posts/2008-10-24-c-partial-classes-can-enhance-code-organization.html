---
layout: post
title: "C# Partial Classes Can Enhance Code Organization"
date: 2008-10-24T14:23:00-06:00
categories:
 - Threading
 - .NET
 - C#
 - Visual Studio
 - UI
 - Microsoft
 - Code Organization
---

<div class='post'>
<p>Many .NET developers are aware of the idea of partial Classes, as they have existed since .NET 2.0.&#160; The primary purpose is to allow you the developer to share claim on a C# Class with Visual Studio's automated code generators (mainly used by the many designers included in Visual Studio), without the automated code generator stomping all over your code additions every time it runs.&#160; For instance, in a Windows Forms application, you get a code-behind Class where you can put your logic, properties, methods, and event handlers; it is a partial Class of the one Visual Studio's Windows Form designer creates and manages for all the UI objects you dragged around in the designer.&#160; A good summarization of this feature is given by <a title="Bart De Smet&#39;s Blog" href="http://community.bartdesmet.net/blogs/bart/default.aspx">Bart De Smet</a>:</p>  <blockquote>   <p>&quot;In short, partial classes allow you to split the definition of a class across multiple files, or alternatively you could think about it as a code compilation unit separated over multiple files.&quot;</p> </blockquote>  <p>As another practical application of this feature, I have occasionally implemented a practice using partial Classes that I learned from a previous coworker.&#160; Occasionally you find yourself with a Class that is inescapably large.&#160; Perhaps it is a web service that has been in use for a while by customers or other groups within your company, and you can't just deprecate the service very easily; so you just keep extending it and adding more web methods to it for additional, similar functionality.&#160; Another potential situation could be that you began designing a simple application all in one file but it grew to be a little bigger than expected, but it doesn't quite merit a whole major redesign into appropriate classes.&#160; I know how this all sounds, but these scenarios aren't exactly uncommon in real-world practice, where there are other factors in consideration.&#160; I suppose many would resort to <a href="http://msdn.microsoft.com/en-us/library/9a1ybwek.aspx">C# <font face="Courier New">regions</font></a>, but I'm not a fan of them as it really only gives the illusion that your code file is better grouped and somehow shorter.</p> <span class='fullpost'> <p>So if you need some decent semblance of organization in a messy class file with little effort, the partial Class feature can come to your rescue.&#160; You can basically create a partial Class file for each grouping of code that you would probably be putting in a C# <font face="Courier New">region</font>.&#160; For instance, a relatively small Windows Form application could be broken up into the following sub-files (all partial Classes of the same <font face="Courier New">MainForm</font> class):</p>  <ul>   <li><strong>MainForm.cs</strong> = contains the constructor and a few rare global enumerations, properties, or sub-classes </li>    <li><strong>MainForm.UI.cs</strong> = contains the event handlers and other supporting methods that interact directly with the UI </li>    <li><strong>MainForm.Processing.cs</strong> = contains the application logic designed to be spun off in a separate worker thread in order to keep the UI thread from blocking while waiting </li>    <li><strong>MainForm.Designer.cs</strong> = the auto-generated UI file from the Windows Form designer </li> </ul>  <p>Obviously you should try to architect your code better from the get-go, but perhaps what you are looking at is legacy code you have inherited from previous developers and the deadline is fast approaching.&#160; There are reasonable circumstances I can think of (and have encountered) where this quick &amp; dirty organization lets you keep an ounce of sanity, so that you can keep moving forward.</p> </span>  </div>
